1) What this utility is for 

CAN (Including MCAN) and UART tests are executed with help of two boards. Two boards are physically connected with wires for send/recv data. 
The board which is under test is called DUT board. The board which is helping to execute the tests is called assist board.


2) Sample of test cases :
Send data from DUT board. Check data is received at assist board.

Step a) Command to run in DUT board
cd /opt/ltp ; export LTPROOT=$(pwd) ; export PATH=$PATH:$(pwd)/testcases/bin ; cd testcases/bin ; can_test.sh can0 1

Step b) Command to run in assist board
cd /opt/ltp ; export LTPROOT=$(pwd) ; export PATH=$PATH:$(pwd)/testcases/bin ; cd testcases/bin ; can_test.sh can0 setup ; candump can0

Step c) Manually/automatically verify data sent at DUT board has arrived to assist board.


3) How to compile the code :
There are two executables. 1) dut-command 2) assist-server

Compiler option is provided in make file. Add your compiler and build.
Make file is provided. Use "make clean ; make" to compile the code


4) How to run the utility

At assist board :
$ nohup /opt/ltp/testcases/bin/assist-server & # will create a nohum.out file
$ nohup /opt/ltp/testcases/bin/assist-server >/dev/null 2>&1 & # will not create nohup.out file


At DUT side : 
# Help
$ /opt/ltp/testcases/bin/dut-client -h

# Run command
$ /opt/ltp/testcases/bin/dut-client "command"
$ /opt/ltp/testcases/bin/dut-client "candump can0"

# Request for assit board console logs
$ /opt/ltp/testcases/bin/dut-client "ConsoleLogsRequest"

# Request for clearing console logs
$ /opt/ltp/testcases/bin/dut-client "ConsoleLogsClear"

# Check the assist board health status
$ /opt/ltp/testcases/bin/dut-client "AssistBoardHealth"


5) How to use the utility in test automation

Step a) At assist board :
$ nohup /opt/ltp/testcases/bin/assist-server >/dev/null 2>&1 & 

Step b) At DUT board test.sh :

#!/bin/sh

./dut-client "ConsoleLogsClear"
./dut-client "cat /proc/cpuinfo"
output=`./dut-client "ConsoleLogsRequest`
if [[ $output == *"test-buffer"* ]]; then
    echo "Test pass"
else
    echo "Test fail"
fi

6) Limitations/Recommendations
Assist board and DUT board should be in same subnet

7) Maximum size logs send/receive can be 2MB.
